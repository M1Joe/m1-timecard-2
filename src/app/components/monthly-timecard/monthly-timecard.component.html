<mat-card>
  <div *ngIf="loading; else show_form">
    Loading timecard data...
  </div>

  <ng-template #show_form>
    <form [formGroup]="timecardForm">
      <div fxLayout="row">
        <button mat-raised-button class="submit-btn" (click)="saveForm()" type="button">Save</button> <!--[disabled]="isSaveAndSubmitDisabled()"-->
        <button mat-raised-button class="submit-btn" (click)="submitForm()" type="button">Submit</button>  <!--[disabled]="isSaveAndSubmitDisabled()"-->
        <span class="status"><b>Status: </b><input type="text" formControlName="status" disabled
            class="fake-input"></span>
      </div>
      <mat-divider></mat-divider>
      <div formArrayName="activities" fxLayout="column">
        <div class="activity-container">
          <div fxLayout="row" class="activity-title">
            <span class="picker-title">Day:</span>
            <span class="hours-title">1</span>
            <span class="hours-title">2</span>
            <span class="hours-title">3</span>
            <span class="hours-title">4</span>
            <span class="hours-title">5</span>
            <span class="hours-title">6</span>
            <span class="hours-title">7</span>
            <span class="hours-title">8</span>
            <span class="hours-title">9</span>
            <span class="hours-title">10</span>
            <span class="hours-title">11</span>
            <span class="hours-title">12</span>
            <span class="hours-title">13</span>
            <span class="hours-title">14</span>
            <span class="hours-title">15</span>
            <span class="hours-title">16</span>
            <span class="hours-title">17</span>
            <span class="hours-title">18</span>
            <span class="hours-title">19</span>
            <span class="hours-title">20</span>
            <span class="hours-title">21</span>
            <span class="hours-title">22</span>
            <span class="hours-title">23</span>
            <span class="hours-title">24</span>
            <span class="hours-title">25</span>
            <span class="hours-title">26</span>
            <span class="hours-title">27</span>
            <span class="hours-title" *ngIf="daysInMonth>=28">28</span>
            <span class="hours-title" *ngIf="daysInMonth>=29">29</span>
            <span class="hours-title" *ngIf="daysInMonth>=30">30</span>
            <span class="hours-title" *ngIf="daysInMonth>=31">31</span>
            <!-- TODO: delete extra days in short months-->
          </div>
          <div *ngFor="let activity of timecardForm.get('activities').controls; let activityIndex = index"
            [formGroupName]="activityIndex" class="activity">

            <!-- <input type="text" formControlName="chargeCode" class="TODO"> -->

            <mat-form-field class="charge-code-picker" appearance="outline">
              <mat-label>ChargeCode</mat-label>
              <mat-select formControlName="chargeCode">
                <!-- [(value)]="chargeCode"-->
                <!--formControlName='name'-->
                <mat-option *ngFor="let chargeCode of chargeCodes$ | async" [value]="chargeCode">{{chargeCode}}
                </mat-option>
              </mat-select>
            </mat-form-field>


            <input type="number" formControlName="d01" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(1) }">
            <input type="number" formControlName="d21" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(2) }">
            <input type="number" formControlName="d03" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(3) }">
            <input type="number" formControlName="d04" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(4) }">
            <input type="number" formControlName="d05" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(5) }">
            <input type="number" formControlName="d06" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(6) }">
            <input type="number" formControlName="d07" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(7) }">
            <input type="number" formControlName="d08" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(8) }">
            <input type="number" formControlName="d09" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(9) }">
            <input type="number" formControlName="d10" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(10) }">
            <input type="number" formControlName="d11" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(11) }">
            <input type="number" formControlName="d12" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(12) }">
            <input type="number" formControlName="d13" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(13) }">
            <input type="number" formControlName="d14" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(14) }">
            <input type="number" formControlName="d15" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(15) }">
            <input type="number" formControlName="d16" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(16) }">
            <input type="number" formControlName="d17" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(17) }">
            <input type="number" formControlName="d18" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(18) }">
            <input type="number" formControlName="d19" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(19) }">
            <input type="number" formControlName="d20" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(20) }">
            <input type="number" formControlName="d21" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(21) }">
            <input type="number" formControlName="d22" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(22) }">
            <input type="number" formControlName="d23" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(23) }">
            <input type="number" formControlName="d24" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(24) }">
            <input type="number" formControlName="d25" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(25) }">
            <input type="number" formControlName="d26" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(26) }">
            <input type="number" formControlName="d27" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(27) }">
            <input type="number" formControlName="d28" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(28) }"
              *ngIf="daysInMonth>=28">
            <input type="number" formControlName="d29" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(29) }"
              *ngIf="daysInMonth>=29">
            <input type="number" formControlName="d30" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(30) }"
              *ngIf="daysInMonth>=30">
            <input type="number" formControlName="d31" [ngClass]="{'hours-input': true, 'weekend' : isWeekend(31) }"
              *ngIf="daysInMonth>=31">


            <button mat-icon-button color="warn" type="button" (click)="removeActivity(activityIndex)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </div>
      </div>
      <button mat-raised-button class="add-btn" (click)="addActivity()" type="button">Add Timecard Activity</button>

      <mat-form-field style="width: 100%" appearance="outline">
        <textarea matInput placeholder="Notes" formControlName="note"></textarea>
      </mat-form-field>


    </form>
  </ng-template>
</mat-card>
<!-- <span>SAVED FORM DATA</span>
  <pre>  {{showSavedValue() | json }}
    </pre>
  <hr />
  <span>LIVE FORM DATA</span>
  <pre>{{showValue() | json}}</pre>
   -->